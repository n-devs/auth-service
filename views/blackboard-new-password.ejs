<!doctype html>
<html>

<head>
    <title>    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office">

<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta name="x-apple-disable-message-reformatting">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="telephone=no" name="format-detection">
    <title></title>
    <style>
        /* CONFIG STYLES Please do not delete and edit CSS styles below */
        /* IMPORTANT THIS STYLES MUST BE ON FINAL EMAIL */
        #outlook a {
            padding: 0;
        }

        .ExternalClass {
            width: 100%;
        }

        .ExternalClass,
        .ExternalClass p,
        .ExternalClass span,
        .ExternalClass font,
        .ExternalClass td,
        .ExternalClass div {
            line-height: 100%;
        }

        .es-button {
            mso-style-priority: 100 !important;
            text-decoration: none !important;
        }

        a[x-apple-data-detectors] {
            color: inherit !important;
            text-decoration: none !important;
            font-size: inherit !important;
            font-family: inherit !important;
            font-weight: inherit !important;
            line-height: inherit !important;
        }

        .es-desk-hidden {
            display: none;
            float: left;
            overflow: hidden;
            width: 0;
            max-height: 0;
            line-height: 0;
            mso-hide: all;
        }

        /*
END OF IMPORTANT
*/
        s {
            text-decoration: line-through;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            font-family: roboto, 'helvetica neue', helvetica, arial, sans-serif;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
        }

        table {
            mso-table-lspace: 0pt;
            mso-table-rspace: 0pt;
            border-collapse: collapse;
            border-spacing: 0px;
        }

        table td,
        html,
        body,
        .es-wrapper {
            padding: 0;
            Margin: 0;
        }

        .es-content,
        .es-header,
        .es-footer {
            table-layout: fixed !important;
            width: 100%;
            height: 100%;
        }

        img {
            display: block;
            border: 0;
            outline: none;
            text-decoration: none;
            -ms-interpolation-mode: bicubic;
        }

        table tr {
            border-collapse: collapse;
        }

        p,
        hr {
            Margin: 0;
        }

        h1,
        h2,
        h3,
        h4,
        h5 {
            Margin: 0;
            line-height: 120%;
            mso-line-height-rule: exactly;
            font-family: roboto, 'helvetica neue', helvetica, arial, sans-serif;
        }

        p,
        ul li,
        ol li,
        a {
            -webkit-text-size-adjust: none;
            -ms-text-size-adjust: none;
            mso-line-height-rule: exactly;
        }

        .es-left {
            float: left;
        }

        .es-right {
            float: right;
        }

        .es-p5 {
            padding: 5px;
        }

        .es-p5t {
            padding-top: 5px;
        }

        .es-p5b {
            padding-bottom: 5px;
        }

        .es-p5l {
            padding-left: 5px;
        }

        .es-p5r {
            padding-right: 5px;
        }

        .es-p10 {
            padding: 10px;
        }

        .es-p10t {
            padding-top: 10px;
        }

        .es-p10b {
            padding-bottom: 10px;
        }

        .es-p10l {
            padding-left: 10px;
        }

        .es-p10r {
            padding-right: 10px;
        }

        .es-p15 {
            padding: 15px;
        }

        .es-p15t {
            padding-top: 15px;
        }

        .es-p15b {
            padding-bottom: 15px;
        }

        .es-p15l {
            padding-left: 15px;
        }

        .es-p15r {
            padding-right: 15px;
        }

        .es-p20 {
            padding: 20px;
        }

        .es-p20t {
            padding-top: 20px;
        }

        .es-p20b {
            padding-bottom: 20px;
        }

        .es-p20l {
            padding-left: 20px;
        }

        .es-p20r {
            padding-right: 20px;
        }

        .es-p25 {
            padding: 25px;
        }

        .es-p25t {
            padding-top: 25px;
        }

        .es-p25b {
            padding-bottom: 25px;
        }

        .es-p25l {
            padding-left: 25px;
        }

        .es-p25r {
            padding-right: 25px;
        }

        .es-p30 {
            padding: 30px;
        }

        .es-p30t {
            padding-top: 30px;
        }

        .es-p30b {
            padding-bottom: 30px;
        }

        .es-p30l {
            padding-left: 30px;
        }

        .es-p30r {
            padding-right: 30px;
        }

        .es-p35 {
            padding: 35px;
        }

        .es-p35t {
            padding-top: 35px;
        }

        .es-p35b {
            padding-bottom: 35px;
        }

        .es-p35l {
            padding-left: 35px;
        }

        .es-p35r {
            padding-right: 35px;
        }

        .es-p40 {
            padding: 40px;
        }

        .es-p40t {
            padding-top: 40px;
        }

        .es-p40b {
            padding-bottom: 40px;
        }

        .es-p40l {
            padding-left: 40px;
        }

        .es-p40r {
            padding-right: 40px;
        }

        .es-menu td {
            border: 0;
        }

        .es-menu td a img {
            display: inline-block !important;
        }

        /* END CONFIG STYLES */
        a {
            font-family: roboto, 'helvetica neue', helvetica, arial, sans-serif;
            font-size: 14px;
            text-decoration: underline;
        }

        h1 {
            font-size: 27px;
            font-style: normal;
            font-weight: normal;
            color: #333333;
        }

        h1 a {
            font-size: 27px;
        }

        h2 {
            font-size: 24px;
            font-style: normal;
            font-weight: bold;
            color: #333333;
        }

        h2 a {
            font-size: 24px;
        }

        h3 {
            font-size: 20px;
            font-style: normal;
            font-weight: bold;
            color: #333333;
        }

        h3 a {
            font-size: 20px;
        }

        p,
        ul li,
        ol li {
            font-size: 14px;
            font-family: roboto, 'helvetica neue', helvetica, arial, sans-serif;
            line-height: 150%;
        }

        ul li,
        ol li {
            Margin-bottom: 15px;
        }

        .es-menu td a {
            text-decoration: none;
            display: block;
        }

        .es-wrapper {
            width: 100%;
            height: 100%;
            /* background-image: ; */
            background-repeat: repeat;
            background-position: center top;
        }

        .es-wrapper-color {
            background-color: #efefef;
            height: 100%;
        }

        .es-content-body {
            background-color: #ffffff;
        }

        .es-content-body p,
        .es-content-body ul li,
        .es-content-body ol li {
            color: #333333;
        }

        .es-content-body a {
            color: #333333;
        }

        .es-header {
            background-color: transparent;
            /* background-image: ; */
            background-repeat: repeat;
            background-position: center top;
        }

        .es-header-body {
            background-color: #ffffff;
        }

        .es-header-body p,
        .es-header-body ul li,
        .es-header-body ol li {
            color: #333333;
            font-size: 14px;
        }

        .es-header-body a {
            color: #333333;
            font-size: 14px;
        }

        .es-footer {
            background-color: transparent;
            /* background-image: ; */
            background-repeat: repeat;
            background-position: center top;
        }

        .es-footer-body {
            background-color: #ffffff;
        }

        .es-footer-body p,
        .es-footer-body ul li,
        .es-footer-body ol li {
            color: #333333;
            font-size: 14px;
        }

        .es-footer-body a {
            color: #333333;
            font-size: 14px;
        }

        .es-infoblock,
        .es-infoblock p,
        .es-infoblock ul li,
        .es-infoblock ol li {
            line-height: 120%;
            font-size: 11px;
            color: #cccccc;
        }

        .es-infoblock a {
            font-size: 11px;
            color: #cccccc;
        }

        .es-button-border {
            border-style: solid solid solid solid;
            border-color: #2cb543 #2cb543 #2cb543 #2cb543;
            background: #2880FF;
            border-width: 0px 0px 0px 0px;
            display: inline-block;
            border-radius: 4px;
            width: auto;
        }

        /* RESPONSIVE STYLES Please do not delete and edit CSS styles below. If you don't need responsive layout, please delete this section. */
        @media only screen and (max-width: 600px) {

            p,
            ul li,
            ol li,
            a {
                font-size: 14px !important;
                line-height: 150% !important;
            }

            h1 {
                font-size: 22px !important;
                text-align: center;
                line-height: 120% !important;
            }

            h2 {
                font-size: 20px !important;
                text-align: center;
                line-height: 120% !important;
            }

            h3 {
                font-size: 18px !important;
                text-align: center;
                line-height: 120% !important;
            }

            h1 a {
                font-size: 22px !important;
            }

            h2 a {
                font-size: 20px !important;
            }

            h3 a {
                font-size: 18px !important;
            }

            .es-menu td a {
                font-size: 13px !important;
            }

            .es-header-body p,
            .es-header-body ul li,
            .es-header-body ol li,
            .es-header-body a {
                font-size: 13px !important;
            }

            .es-footer-body p,
            .es-footer-body ul li,
            .es-footer-body ol li,
            .es-footer-body a {
                font-size: 13px !important;
            }

            .es-infoblock p,
            .es-infoblock ul li,
            .es-infoblock ol li,
            .es-infoblock a {
                font-size: 11px !important;
            }

            *[class="gmail-fix"] {
                display: none !important;
            }

            .es-m-txt-c,
            .es-m-txt-c h1,
            .es-m-txt-c h2,
            .es-m-txt-c h3 {
                text-align: center !important;
            }

            .es-m-txt-r,
            .es-m-txt-r h1,
            .es-m-txt-r h2,
            .es-m-txt-r h3 {
                text-align: right !important;
            }

            .es-m-txt-l,
            .es-m-txt-l h1,
            .es-m-txt-l h2,
            .es-m-txt-l h3 {
                text-align: left !important;
            }

            .es-m-txt-r img,
            .es-m-txt-c img,
            .es-m-txt-l img {
                display: inline !important;
            }

            .es-button-border {
                display: block !important;
            }

            .es-btn-fw {
                border-width: 10px 0px !important;
                text-align: center !important;
            }

            .es-adaptive table,
            .es-btn-fw,
            .es-btn-fw-brdr,
            .es-left,
            .es-right {
                width: 100% !important;
            }

            .es-content table,
            .es-header table,
            .es-footer table,
            .es-content,
            .es-footer,
            .es-header {
                width: 100% !important;
                max-width: 600px !important;
            }

            .es-adapt-td {
                display: block !important;
                width: 100% !important;
            }

            .adapt-img {
                width: 100% !important;
                height: auto !important;
            }

            .es-m-p0 {
                padding: 0px !important;
            }

            .es-m-p0r {
                padding-right: 0px !important;
            }

            .es-m-p0l {
                padding-left: 0px !important;
            }

            .es-m-p0t {
                padding-top: 0px !important;
            }

            .es-m-p0b {
                padding-bottom: 0 !important;
            }

            .es-m-p20b {
                padding-bottom: 20px !important;
            }

            .es-mobile-hidden,
            .es-hidden {
                display: none !important;
            }

            tr.es-desk-hidden,
            td.es-desk-hidden,
            table.es-desk-hidden {
                width: auto !important;
                overflow: visible !important;
                float: none !important;
                max-height: inherit !important;
                line-height: inherit !important;
            }

            tr.es-desk-hidden {
                display: table-row !important;
            }

            table.es-desk-hidden {
                display: table !important;
            }

            td.es-desk-menu-hidden {
                display: table-cell !important;
            }

            .es-menu td {
                width: 1% !important;
            }

            table.es-table-not-adapt,
            .esd-block-html table {
                width: auto !important;
            }

            table.es-social {
                display: inline-block !important;
            }

            table.es-social td {
                display: inline-block !important;
            }

            a.es-button,
            button.es-button {
                font-size: 14px !important;
                display: block !important;
                border-left-width: 0px !important;
                border-right-width: 0px !important;
            }
        }

        /* END RESPONSIVE STYLES */
        a.es-button,
        button.es-button {
            border-style: solid;
            border-color: #2880FF;
            border-width: 10px 20px 10px 20px;
            display: inline-block;
            background: #2880FF;
            border-radius: 4px;
            font-size: 18px;
            font-family: roboto, 'helvetica neue', helvetica, arial, sans-serif;
            font-weight: bold;
            font-style: normal;
            line-height: 120%;
            color: #fff;
            text-decoration: none;
            width: auto;
            text-align: center;
        }
    </style>
    <!--[if (mso 16)]>
    <style type="text/css">
    a {text-decoration: none;}
    </style>
    <![endif]-->
    <!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]-->
    <!--[if gte mso 9]>
<xml>
    <o:OfficeDocumentSettings>
    <o:AllowPNG></o:AllowPNG>
    <o:PixelsPerInch>96</o:PixelsPerInch>
    </o:OfficeDocumentSettings>
</xml>
<![endif]-->
    <script async custom-template="amp-mustache" src="https://cdn.ampproject.org/v0/amp-mustache-0.2.js"></script>
</head>

<body>
    <div class="es-wrapper-color">
        <!--[if gte mso 9]>
			<v:background xmlns:v="urn:schemas-microsoft-com:vml" fill="t">
				<v:fill type="tile" color="#efefef"></v:fill>
			</v:background>
		<![endif]-->
        <table class="es-wrapper" width="100%" cellspacing="0" cellpadding="0">
            <tbody>
                <tr>
                    <td class="esd-email-paddings" valign="top">
               
                        <table class="es-content es-visible-simple-html-only" cellspacing="0" cellpadding="0" align="center">
                            <tbody>
                                <tr>
                                    <td class="esd-stripe esd-checked" align="center" style="background-image:url(https://firebasestorage.googleapis.com/v0/b/iceberg-48326.appspot.com/o/images%2Fmail%2Fbg-0.svg?alt=media&token=a36e5263-830e-4765-bff3-bfe911557fdb);background-position: center; background-repeat: no-repeat;" background="https://firebasestorage.googleapis.com/v0/b/iceberg-48326.appspot.com/o/images%2Fmail%2Fbg-0.svg?alt=media&token=a36e5263-830e-4765-bff3-bfe911557fdb" esd-custom-block-id="61180">
                                        <table class="es-content-body" width="600" cellspacing="0" cellpadding="0" bgcolor="transparent" align="center" style="background-color: transparent;">
                                            <tbody>
                                                <tr>
                                                    <td class="es-p20t es-p20r es-p20l esd-structure" align="left">
                                                        <table width="100%" cellspacing="0" cellpadding="0">
                                                            <tbody>
                                                                <tr>
                                                                    <td class="esd-container-frame es-m-p20b" width="321" valign="top" align="center">
                                                                        <table width="100%" cellspacing="0" cellpadding="0" bgcolor="transparent" style="background-color: transparent;">
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td class="esd-container-frame es-m-p20b" width="321" valign="top" align="center">
                                                                                        <table width="100%" cellspacing="0" cellpadding="0" bgcolor="transparent"
                                                                                            style="background-color: transparent;">
                                                                                            <tbody>
                                                                                                <tr class="esd-mobile-hidden">
                                                                                                    <td align="center" class="esd-block-spacer" height="62"></td>
                                                                                                </tr>
                                                                                                <tr>
                                                                                                    <td align="center" class="esd-block-spacer" height="24"></td>
                                                                                                </tr>
                                                                                                <tr>
                                                                                                    <td class="esd-block-text es-p35t es-p5r es-p5l" bgcolor="transparent"
                                                                                                        align="center">
                                                                                                        <h2>${email}</h2>
                                                                                                    </td>
                                                                                                </tr>
                                                                 
                                                                                                <tr>
                                                                                                    <td align="center" class="esd-block-button es-p20t es-p30b es-p10r es-p10l"><span
                                                                                                            class="es-button-border"><a href="https://auth.iceberg-th.com/blackboard/new-password?id=${id}&email=${email}"
                                                                                                                class="es-button" target="_blank" style="border-width: 10px 20px;">สร้างรหัสผ่านใหม่</a></span></td>
                                                                                                </tr>
                                                                                                <tr class="esd-mobile-hidden">
                                                                                                    <td align="center" class="esd-block-spacer" height="45"></td>
                                                                                                </tr>
                                                                                            </tbody>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</body>

</html></title>
    <!-- Latest compiled and minified CSS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css"
        href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">
    <style>
        html,
        body {
            height: 100%;
            width: 100%;
            /* margin-top: 20px; */
        }


        .card-box .card-drop {
            color: #9a9da0;
            font-size: 20px;
            line-height: 1px;
            padding: 0px 5px;
            display: inline-block;
        }

        /* .text-success {
     !important;
} */
        .text-muted {
            color: #9a9da0 !important;
        }

        /* .logo-alt-box .logo {
    
     !important;  
} */
        .logo-alt-box h5 {}

        .btn-blackboard {
            background: linear-gradient(47.65deg, #23BCFF 0%, #004AC6 95.79%);
            /* border-radius: 30px; */

        }
    </style>
</head>

<body>
    <div style="background: #f5f5f5;padding-bottom:100px;padding-top:100px;    height: 100%;">
        <div class="row bootstrap snippets bootdeys">
            <div class="col-md-5 col-md-offset-3">

                <div class="m-t-30 card-box"
                    style="margin-bottom: 20px;background-clip: padding-box;-moz-border-radius: 5px;border-radius: 5px;-webkit-border-radius: 5px;padding: 20px;background-color: #ffffff;box-shadow: 0 8px 42px 0 rgba(0, 0, 0, 0.08);">
                    <div class="text-center">
                        <h4 class="text-uppercase font-bold m-b-0">สร้างรหัสผ่านใหม่</h4>
                    </div>

                    <div class="panel-body text-center">
                        <div class="form-group">
                            <label for="exampleInputEmail1">New Password</label>
                            <input type="password" class="form-control" id="password" name="password"
                                aria-describedby="emailHelp" placeholder="Enter password">
                            <!-- <small id="emailHelp" class="form-text text-muted">We'll never share your email with
                                anyone else.</small> -->
                        </div>
                        <div class="form-group">
                            <label for="exampleInputPassword1">Confirm Password</label>
                            <input type="password" class="form-control" id="password_conf" name="password_conf"
                                placeholder="Confirm Password">
                        </div>

                        <button type="submit" class="btn btn-blackboard"
                            onclick="newPassword()">เปลี่ยนรหัสผ่าน</button>

                    </div>

                </div>
            </div>
        </div>
    </div>
    <!-- <div class="bs-example">
        <div class="alert alert-danger fade in">
            <a href="#" class="close" data-dismiss="alert">&times;</a>
            <strong>Error!</strong> A problem has been occurred while submitting your data.
        </div>
    </div> -->
    <script>

        function createElementFromHTML(htmlString) {
            var div = document.createElement('div');
            div.innerHTML = htmlString.trim();

            // Change this to div.childNodes to support multiple top-level nodes
            return div.firstChild;
        }
        function newPassword() {
            var alert = document.createElement("div");
            var buttonClose = document.createElement("button");
            var iClose = document.createElement("i");
            var strong = document.createElement("strong");
            var myHeaders = new Headers();
            myHeaders.append("Content-Type", "application/json");

            const password = document.getElementById('password')
            const passwordConf = document.getElementById('password_conf')

            // console.log({ "id": data.id, "password": `${password.value}`, "password_conf": `${passwordConf.value}` });
            // console.log({ "id": `${<%= data.id %>}`, "password": `${password.value}`, "password_conf": `${passwordConf.value}` });

            var raw = JSON.stringify({ "id": `${<%= data.id %>}`, "password": `${ password.value }`, "password_conf": `${ passwordConf.value }` });

            var requestOptions = {
                method: 'POST',
                headers: myHeaders,
                body: raw,
                redirect: 'follow'
            };

            fetch("/api/blackboard/new-password", requestOptions)
                .then(response => response.text())
                .then(result => {
                    const json_data = JSON.parse(result);
console.log(json_data);
                    if(json_data.status) {
                       
                        let successText = document.createTextNode("Success!")
                        let msgText = document.createTextNode(json_data.message)
                        alert.setAttribute("class","alert alert-success fade in")
                        alert.setAttribute("style","position: absolute; bottom: 0;margin-left: 10px;")
                        buttonClose.setAttribute("class","close");
                        buttonClose.setAttribute("style","padding: 0px 10px;font-size: 19px;")
                        buttonClose.setAttribute("data-dismiss","alert");
                        buttonClose.setAttribute("aria-label","Close");
                        iClose.setAttribute("class","glyphicon glyphicon-remove");
                        buttonClose.appendChild(iClose)
                        strong.setAttribute("style","padding:10px")
                        strong.appendChild(successText)
                        alert.appendChild(strong);
                        alert.appendChild(msgText)
                        alert.appendChild(buttonClose);
                        
                        document.body.appendChild(alert); 
                    }else{
                        let errText = document.createTextNode("Error!")
                        let msgText = document.createTextNode(json_data.message)
                        alert.setAttribute("class","alert alert-danger fade in")
                        alert.setAttribute("style","position: absolute; bottom: 0;margin-left: 10px;")
                        buttonClose.setAttribute("style","padding: 0px 10px;font-size: 19px;")
                        buttonClose.setAttribute("class","close");
                        buttonClose.setAttribute("data-dismiss","alert");
                        buttonClose.setAttribute("aria-label","Close");
                        iClose.setAttribute("class","glyphicon glyphicon-remove");
                        buttonClose.appendChild(iClose)
                        strong.setAttribute("style","padding:10px")
                        strong.appendChild(errText)
                        alert.appendChild(strong);
                        alert.appendChild(msgText)
                        alert.appendChild(buttonClose);
                        
                        document.body.appendChild(alert); 
                    }
                    console.log(json_data);
                    console.log(result)})
                .catch(error => console.log('error', error));
        }
    </script>
</body>



</html>